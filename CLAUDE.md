# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**Logosyncx** is a Go CLI tool (`logos`) for managing AI agent conversation context in git repositories. It lets agents save, search, and retrieve past session summaries — enabling team-wide context sharing without external databases or embedding servers.

The full design spec is in `ClaudeLogoSyncDesign.md`.

## Task Tracking

This project uses **logos tasks** for issue tracking, stored in `.logosyncx/tasks/`.

```bash
logos task ls --status open --json                        # Find available work
logos task refer --name <name>                            # View task details
logos task update --name <name> --status in_progress      # Claim a task
logos task update --name <name> --status done             # Complete a task (deletes the file)
logos sync                                                # Rebuild session and task indexes
```

**Session completion is mandatory** — see `AGENTS.md` for the full workflow including required `git push`.

## Tech Stack

| Component | Library |
|-----------|---------|
| CLI framework | [cobra](https://github.com/spf13/cobra) |
| Git operations | [go-git](https://github.com/go-git/go-git) (only `git add` automation) |
| Markdown/frontmatter | [goldmark](https://github.com/yuin/goldmark) + [yaml.v3](https://github.com/go-yaml/yaml) |
| Interactive UI (Phase 2) | [bubbletea](https://github.com/charmbracelet/bubbletea) |

Distribution: single binary, Homebrew tap, `curl | bash` (no Node.js/Python dependency).

## Architecture

### Data Layout (inside a user's project)

```
.logosyncx/
├── config.json        # Project config (summary_sections, privacy filters, etc.)
├── USAGE.md           # Agent-facing command reference (generated by logos init)
├── template.md        # Session file template (customizable per team)
├── sessions/          # One .md file per saved session (date_topic.md)
└── knowledge/         # Distilled shared knowledge (Phase 3)
```

Sessions are plain markdown files with YAML frontmatter (`id`, `date`, `topic`, `tags`, `agent`, `related`, `excerpt`). No database — agents do semantic reasoning over excerpts themselves via `logos ls --json`.

### Key Commands to Implement

- `logos init` — create `.logosyncx/`, append to `AGENTS.md`, generate `USAGE.md`
- `logos ls [--tag] [--since] [--json]` — list sessions; `--json` returns structured output with excerpts for agent consumption
- `logos refer --name <name> [--summary]` — print session content; `--summary` returns only `summary_sections` from config to save tokens
- `logos search --keyword <keyword>` — keyword filter on topic, tags, and excerpt (human-use complement to agent's own semantic reasoning)
- `logos save --topic <topic> [--section "Name=content"]` — validate, auto-fill `id`/`date`, save to `sessions/`, run `git add`; body content is provided exclusively via `--section` flags using names defined in `config.json`
- `logos sync` — rebuild index from session files
- `logos status` — show unsaved/uncommitted sessions
- `logos setup claude|cursor|aider` — integrate with agent config files (Phase 2)

### Design Principles

- **Agents do semantic search themselves** — `logos ls --json` returns excerpts; the LLM judges relevance. No vector DB or embedding API needed.
- **Token budget awareness** — `logos refer --summary` exists so agents don't load full conversation logs unnecessarily.
- **git add is automatic; git commit/push is the user's responsibility** after `logos save`.
- **No interactive prompts in agent-facing commands** — `logos save --file/--stdin` is fully non-interactive.

## Development Notes

- This is a **Go** project. Follow Go conventions (not the TypeScript/TDD rules in the global CLAUDE.md).
- Tests: use `go test ./...`
- Build: `go build -o logos .`
- The project is currently in the design phase — `ClaudeLogoSyncDesign.md` is the authoritative spec.
- **Language policy: all code, comments, commit messages, issue titles/descriptions, and documentation must be written in English.**

## Logosyncx

Use `logos` CLI for session context management.
Full reference: .logosyncx/USAGE.md
